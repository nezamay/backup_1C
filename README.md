# backup_1C
Комплексная выгрузка баз 1С 8.* с сервера приложений
Настройка параметров выгрузки производится в xml-файле. Структура и описание параметров xml смотреть в ./config.xsd
В качестве компоненты работы с ftp используется freeware dll-ка ChilkatFTP (сейчас правда ее убрали с сайта производителя).
Расположена в папке ./ftp/

запуск в назначенных заданиях (пример):
C:\WINDOWS\system32\wscript.exe "X:\vbs\back_up.vbs" "X:\vbs_config\config_backup.xml" - для 32 битных систем
C:\WINDOWS\SysWOW64\wscript.exe "X:\vbs\back_up.vbs" "X:\vbs_config\config_backup.xml" - для 64 битных систем
Можно также зарегистрировать в системе 32-битные компоненты как 64-битные.
как это сделать, читаем http://devtrainingforum.v8.1c.ru/forum/thread.jsp?id=555004, http://infostart.ru/public/197627/

Параметры вынесены в конфигурационный файл. При неуказании конфиг. файла при запуске скрипта ищет config.xml в папке со скриптом - туда можно поместить дефолтный конфиг. файл
без конф. файла выгрузка прерывается, т.к. непонятно что делать
при наличии схемы проверки xsd с именем config.xsd в папке скрипта происходит валидация конфиг. файла. Очень рекомендуется! При отсутствии схемы валидация пропускается.
процесс выгрузки пишется в файл [имя скрипта].log в папке скрипта. См. SendError
при отсутствии указании в конфиг. файле папки, куда ложить выгрузки, пишет во временную папку. См. GetTempUploadFolderPath
также временная папка используется при переброске файлов по ftp на удаленный сервер хранения архивов

Базы выгружаются по очереди. При возникновении некритических ошибок (с двумя ! в описании) выгрузка следующих баз продолжается.
Перед выгрузкой происходит отключение пользователей из базы (кроме монопольно сидящих и конфигуратора) через кластер 1С. Никаких taskkill! См. DisconnectUsers
поиск ядра 1С происходит через реестр. Тестировано на х86 и на х64 с 32битным ядром 1С (8.2.19.130, 8.3.9.2170)
